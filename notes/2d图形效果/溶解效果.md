# 溶解效果

## 概念


## 原理
为了实现这种效果，需要标记出哪些像素显示、哪些像素消失，比较好的办法是用一张噪声图来给每一个像素做标记。由于噪声图只有黑白灰三种颜色，黑白灰非均匀分布，因此，可以利用黑透、白不透、灰半透的原理实现不规则溶解效果。

## 实现思路
1. 根据溶解贴图的rgb某个通道的颜色与溶解阈值对比，如果小于溶解阈值则舍弃

## 进阶

进阶版本的溶解效果增加了以下特性：

### 1. 发光边缘（Glow Edge）
- 在溶解边缘区域添加发光效果
- 使用 `smoothstep` 函数实现平滑的边缘过渡
- 通过 `edgeWidth` 参数控制发光区域宽度
- 通过 `glowIntensity` 参数控制发光强度

### 2. 边缘颜色（Edge Color）
- 支持自定义边缘颜色，模拟燃烧效果
- 默认颜色为燃烧色（橙红色）：`(1.0, 0.3, 0.0, 1.0)`
- 边缘颜色会与原始纹理颜色混合，产生自然的过渡
- 可通过 `edgeColor` 参数调整边缘颜色

### 3. UV动画（UV Animation）
- 支持噪声贴图的UV滚动动画
- 通过 `uvSpeed` 参数控制UV偏移速度（vec2类型）
- 默认设置为 `(0.0, -0.1)`，实现向上滚动效果
- 可用于模拟动态燃烧、能量波动等效果

### 实现细节
1. **平滑边缘计算**：
   ```glsl
   float edgeStart = dissolveThreshold;
   float edgeEnd = dissolveThreshold + edgeWidth;
   float edgeFactor = smoothstep(edgeStart, edgeEnd, dissolveValue);
   ```

2. **发光强度计算**：
   - 计算从边缘到内部的距离
   - 归一化后使用平滑函数计算发光强度
   - 越靠近溶解阈值的像素发光越强

3. **颜色混合**：
   - 在边缘区域使用 `mix` 函数混合边缘颜色
   - 添加额外的亮度增强，使边缘更加明显

4. **UV动画偏移**：
   ```glsl
   vec2 uvOffset = v_uv0 + cc_time.y * uvSpeed;
   vec4 dissolveColor = texture(dissolveMap, uvOffset);
   ```

### 参数说明
- `dissolveThreshold`：溶解阈值（0-1），控制溶解程度
- `edgeWidth`：边缘宽度（0-0.3），控制发光区域大小
- `glowIntensity`：发光强度（0-3），控制边缘亮度
- `edgeColor`：边缘颜色，RGBA格式
- `uvSpeed`：UV动画速度，vec2类型（x, y方向的速度）

### 应用场景
- 角色/物品消失动画（如死亡、销毁）
- 魔法效果（传送、变形）
- 燃烧效果（纸张、布料燃烧）
- UI元素过渡动画


## 效果
![溶解效果](../../resource/image/溶解效果.gif)
![纸张燃烧效果](../../resource/image/纸张燃烧.gif)